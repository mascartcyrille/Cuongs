%
% Se compile en utilisant le Makefile (sage inside)
%
\documentclass{article}
\usepackage{graphicx}
\usepackage{amssymb,amsmath}
\usepackage{hyperref}
\usepackage[latin1]{inputenc}
\usepackage{enumitem}
\usepackage{sagetex}
\usepackage{mathabx}
\usepackage{dsfont}
\usepackage[ruled]{algorithm}
\usepackage{algorithmicx}
\usepackage[noend]{algpseudocode}
\algrenewcommand{\algorithmiccomment}[1]{\hfill \# {\scriptsize #1}} 
\algnewcommand\algorithmicinput{\textbf{Input:}}
\algnewcommand\Input{\item[\algorithmicinput]}
\algnewcommand\algorithmicoutput{\textbf{Output:}}
\algnewcommand\Output{\item[\algorithmicoutput]}
\algnewcommand\algodesc{\textbf{Description:}}
\algnewcommand\Desc{\item[\algodesc]}
\algnewcommand\algouse{\textbf{Usage:}}
\algnewcommand\Use{\item[\algouse]}
\newcommand{\be}{\begin{eqnarray*}}
\newcommand{\ee}{\end{eqnarray*}}
\newcommand{\ben}{\begin{eqnarray}}
\newcommand{\een}{\end{eqnarray}}
\newcommand{\dsp}{\displaystyle}
\makeatletter
\newcommand{\algrule}[1][.2pt]{\par\vskip.5\baselineskip\hrule height #1\par\vskip.5\baselineskip}
\makeatother
\DeclareMathOperator\erf{erf}
\def\E{\mathbb{E}}
\def\R{\mathbb{R}}
\def\Tmin{T_{\min}}
\def\Tmax{T^{\max}}
\def\mzero{\widehat{m}_0}
\usepackage{array}
%\usepackage{showframe}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\begin{document}
\begin{itemize}
\item $\delta=0.02$, $K=5$ (donc $A=0.1$)
\item $]\Tmin,\Tmax]=]0,8]$
\item Le vecteur low n'a pas été pris en compte dans le temps calcul de G
\item Ici la dernière version V2 est faite en C++ avec armadillo. L'interfaçage avec R (RcppArmadillo) semble donner des temps comparables à C++  armadillo.
\item Les mesures ont été faites sur math11 - elles sont relatives car d'autres utilisateurs pouvaient l'uitliser en même temps
\item Le temps calcul pour neuro-stat regroupe les temps calcul de $G$, $\mu_1$, $\mu_2$ et $\mu_A$
\item La version PWC est ma version C++ armadillo avec les fonctions constantes par morceaux
%\item Dans le tableau, l'erreur entre NeuroCorr et la dernière version est assez grande pour les 2 derniers exemples (1e-5)
\end{itemize}
\begin{sagesilent}
import numpy as np
Gns = {10: 0.023, 50: 0.433, 100: 1.329, 200 : 5.444, 500: 33.811, 1000: 135.266}
G = {10: 0.0039635, 50: 0.0563278, 100: 0.186973, 200 : 0.606324, 500: 5.61699, 1000: 29.2367}
b = {10: 0.000452239, 50: 0.00623007, 100: 0.0189842, 200 : 0.0585475, 500: 0.381913, 1000: 1.64153}
bpw = {10: 0.0103129, 50: 0.166311, 100: 0.51991, 200 : 2.04569, 500: 12.9949, 1000: 52.0342}
b_300 = {100: 0.0735659, 1000: 7.86702}
#G_300 = {100: 0.706314, 1000: 132.815}
G_300 = {100: 0.74474, 1000: 141.065}
Gk = {10: 0.0057983, 50: 0.0879065, 100: 0.253229, 200 : 1.00483, 500: 7.87857, 1000: 37.1691}
#Gk_300 = {100: 1.20614, 1000: 171.009}
Gk_300 = {100: 1.2538, 1000: 167.171}
Gpw = {10: 0.0260233, 50: 0.354829, 100: 1.11726, 200 : 4.45412, 500: 27.913, 1000: 111.757}
bpw_300 = {100: 6.91051, 1000: 668.701}
#Gpw_300 = {100: 6.67172, 1000: 628.077}
Gpw_300 = {100: 6.91094, 1000: 628.263}
#Gns_300 = {100: 2.977, 1000: 294.479}
Gns_300 = {100: 3.042, 1000: 325.881}
errGGk = {10: 9.99201e-16, 50: 1.11022e-15, 100: 1.11022e-15, 200 : 1.11022e-15, 500: 1.11022e-15, 1000: 1.11022e-15}
errGGpw = {10: 3.9968e-15, 50: 3.9968e-15, 100: 3.9968e-15, 200 : 1.02141e-14, 500: 1.02141e-14, 1000: 1.02141e-14}
errGGns = {10: 2.9976e-15, 50: 3.10862e-15, 100: 3.9968e-15, 200 : 1.02141e-14, 500: 1.02141e-14, 1000: 1.02141e-14}
errGpwGns = {10: 1.9984e-15, 50: 3.10862e-15, 100: 3.10862e-15, 200 : 3.9968e-15, 500: 9.76996e-15, 1000:  9.76996e-15}
#errGGns_300 = {100: 3.1244e-05, 1000: 3.5299e-05}
errGGns_300 = {100: 4.20108e-13, 1000: 4.60076e-13}
#errGGk_300 = {100: 1.02141e-14, 1000: 1.02141e-14}
errGGk_300 = {100: 0 , 1000: 0}
#errGGpw_300 = {100:  3.10862e-13, 1000: 3.28626e-13}
errGGpw_300 = {100: 3.10862e-13 , 1000: 3.30402e-13}
#errGpwGns_300 = {100: 3.1244e-05, 1000: 3.5299e-05}
errGpwGns_300 = {100: 3.79696e-13, 1000: 5.00933e-13}
\end{sagesilent}
\begin{table}
\resizebox{\textwidth}{!}{
  {\renewcommand{\arraystretch}{1.2}
  \begin{tabular}{|P{2.45cm}|P{1.5cm}|P{1.15cm}|P{1.3cm}|P{1.15cm}|P{1.1cm}|P{1.1cm}|P{1.1cm}|P{1.1cm}|}
\hline
Temps en secondes  & NeuroCorr (neuro-stat). Total (Gns) & Version V2 (sans $k_1$, $k_2$). matrice G & Version V2 (avec $k_1$, $k_2$). matrice Gk & Version PWC. matrice Gpw & Erreur {\small{$\|G-Gk\|_{\infty}$}} & Erreur {\small{$\|G-Gpw\|_{\infty}$}} & Erreur {\small{$\|G-Gns\|_{\infty}$}} & Erreur {\small{$\|Gpw-Gns\|_{\infty}$}} \\
\hline
\hline
{\small{M=10 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[10]))}$ & $\sage{"{0:.2f}".format(float(G[10]))}$ & $\sage{"{0:.2f}".format(float(Gk[10]))}$ & $\sage{"{0:.2f}".format(float(Gpw[10]))}$ & $\sage{"{0:.2g}".format(float(errGGk[10]))}$ &$\sage{"{0:.2g}".format(float(errGGpw[10]))}$ &$\sage{"{0:.2g}".format(float(errGGns[10]))}$&$\sage{"{0:.2g}".format(float(errGpwGns[10]))}$ \\
\hline
{\small{M=50 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[50]))}$ & $\sage{"{0:.2f}".format(float(G[50]))}$ & $\sage{"{0:.2f}".format(float(Gk[50]))}$ & $\sage{"{0:.2f}".format(float(Gpw[50]))}$ & $\sage{"{0:.2g}".format(float(errGGk[50]))}$ &$\sage{"{0:.2g}".format(float(errGGpw[50]))}$ &$\sage{"{0:.2g}".format(float(errGGns[50]))}$&$\sage{"{0:.2g}".format(float(errGpwGns[50]))}$\\
\hline
{\small{M=100 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[100]))}$ & $\sage{"{0:.2f}".format(float(G[100]))}$ & $\sage{"{0:.2f}".format(float(Gk[100]))}$ & $\sage{"{0:.2f}".format(float(Gpw[100]))}$  & $\sage{"{0:.2g}".format(float(errGGk[100]))}$ &$\sage{"{0:.2g}".format(float(errGGpw[100]))}$ &$\sage{"{0:.2g}".format(float(errGGns[100]))}$&$\sage{"{0:.2g}".format(float(errGpwGns[100]))}$\\
\hline
{\small{M=200 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[200]))}$ & $\sage{"{0:.2f}".format(float(G[200]))}$ & $\sage{"{0:.2f}".format(float(Gk[200]))}$ & $\sage{"{0:.2f}".format(float(Gpw[200]))}$  & $\sage{"{0:.2g}".format(float(errGGk[200]))}$ &$\sage{"{0:.2g}".format(float(errGGpw[200]))}$ &$\sage{"{0:.2g}".format(float(errGGns[200]))}$&$\sage{"{0:.2g}".format(float(errGpwGns[200]))}$\\
\hline
{\small{M=500 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[500]))}$ & $\sage{"{0:.2f}".format(float(G[500]))}$ & $\sage{"{0:.2f}".format(float(Gk[500]))}$ & $\sage{"{0:.2f}".format(float(Gpw[500]))}$ & $\sage{"{0:.2g}".format(float(errGGk[500]))}$ &$\sage{"{0:.2g}".format(float(errGGpw[500]))}$ &$\sage{"{0:.2g}".format(float(errGGns[500]))}$&$\sage{"{0:.2g}".format(float(errGpwGns[500]))}$\\
\hline
{\small{M=1000 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[1000]))}$ & $\sage{"{0:.2f}".format(float(G[1000]))}$ & $\sage{"{0:.2f}".format(float(Gk[1000]))}$ & $\sage{"{0:.2f}".format(float(Gpw[1000]))}$ & $\sage{"{0:.2g}".format(float(errGGk[1000]))}$ &$\sage{"{0:.2g}".format(float(errGGpw[1000]))}$ &$\sage{"{0:.2g}".format(float(errGGns[1000]))}$&$\sage{"{0:.2g}".format(float(errGpwGns[1000]))}$\\
\hline
%{\small{M=100 ($\simeq$300 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns_300[100]))}$ & $\sage{"{0:.2f}".format(float(G_300[100]))}$ & $\sage{"{0:.2f}".format(float(Gk_300[100]))}$ & $\sage{"{0:.2f}".format(float(Gpw_300[100]))}$ & $\sage{"{0:.2g}".format(float(errGGk_300[100]))}$ &$\sage{"{0:.2g}".format(float(errGGpw_300[100]))}$ &$\sage{"{0:.2g}".format(float(errGGns_300[100]))}$&$\sage{"{0:.2g}".format(float(errGpwGns_300[100]))}$\\
\hline
%{\small{M=1000 ($\simeq$300 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns_300[1000]))}$ & $\sage{"{0:.2f}".format(float(G_300[1000]))}$ & $\sage{"{0:.2f}".format(float(Gk_300[1000]))}$ & $\sage{"{0:.2f}".format(float(Gpw_300[1000]))}$ & $\sage{"{0:.2g}".format(float(errGGk_300[1000]))}$ &$\sage{"{0:.2g}".format(float(errGGpw_300[1000]))}$ &$\sage{"{0:.2g}".format(float(errGGns_300[1000]))}$&$\sage{"{0:.2g}".format(float(errGpwGns_300[1000]))}$\\
{\small{M=100 ($\simeq$300 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns_300[100]))}$ & $\sage{"{0:.2f}".format(float(G_300[100]))}$ & $\sage{"{0:.2f}".format(float(Gk_300[100]))}$ & $\sage{"{0:.2f}".format(float(Gpw_300[100]))}$ & $\sage{"{0:.2g}".format(float(errGGk_300[100]))}$ &$\sage{"{0:.2g}".format(float(errGGpw_300[100]))}$ &$\sage{"{0:.2g}".format(float(errGGns_300[100]))}$&$\sage{"{0:.2g}".format(float(errGpwGns_300[100]))}$\\
\hline
{\small{M=1000 ($\simeq$300 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns_300[1000]))}$ & $\sage{"{0:.2f}".format(float(G_300[1000]))}$ & $\sage{"{0:.2f}".format(float(Gk_300[1000]))}$ & $\sage{"{0:.2f}".format(float(Gpw_300[1000]))}$ & $\sage{"{0:.2g}".format(float(errGGk_300[1000]))}$ &$\sage{"{0:.2g}".format(float(errGGpw_300[1000]))}$ &$\sage{"{0:.2g}".format(float(errGGns_300[1000]))}$&$\sage{"{0:.2g}".format(float(errGpwGns_300[1000]))}$\\
\hline
\end{tabular}}}
\end{table}    


%\begin{table}
%\resizebox{\textwidth}{!}{
%  {\renewcommand{\arraystretch}{1.2}
%  \begin{tabular}{|P{2.6cm}|P{1.5cm}|P{1.3cm}|P{1.3cm}|P{1.3cm}|P{1cm}|P{1cm}|P{1cm}|P{1cm}|}
%\hline
%Temps en sec  & NeuroCorr (neuro-stat). Total (bns) & Version V2. Vecteur b & Version PWC. Vecteur bpw & Erreur $\|bns-b\|$ & Erreur $\|b-bpw\|$ & Erreur $\|bns-bpw\|$ \\
%\hline
%\hline
%{\small{M=10 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[10]))}$ & $\sage{"{0:.2f}".format(float(b[10]))}$  & $\sage{"{0:.2f}".format(float(bpw[10]))}$ & 0 & && \\
%\hline
%{\small{M=50 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[50]))}$ & $\sage{"{0:.2f}".format(float(b[50]))}$  & $\sage{"{0:.2f}".format(float(bpw[50]))}$ & 0 & && \\
%\hline
%{\small{M=100 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[100]))}$ & $\sage{"{0:.2f}".format(float(b[100]))}$  & $\sage{"{0:.2f}".format(float(bpw[100]))}$ & 0 & && \\
%\hline
%{\small{M=200 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[200]))}$ & $\sage{"{0:.2f}".format(float(b[200]))}$  & $\sage{"{0:.2f}".format(float(bpw[200]))}$ & 0 & && \\
%\hline
%{\small{M=500 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[500]))}$ & $\sage{"{0:.2f}".format(float(b[500]))}$  & $\sage{"{0:.2f}".format(float(bpw[500]))}$ & 0 & && \\
%\hline
%{\small{M=1000 ($\simeq$50 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns[1000]))}$ & $\sage{"{0:.2f}".format(float(b[1000]))}$  & $\sage{"{0:.2f}".format(float(bpw[1000]))}$ & 0 & && \\
%\hline
%{\small{M=100 ($\simeq$300 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns_300[100]))}$ & $\sage{"{0:.2f}".format(float(b_300[100]))}$  & $\sage{"{0:.2f}".format(float(bpw_300[100]))}$ & 0 & && \\
%\hline
%{\small{M=1000 ($\simeq$300 spikes/neurone)}}&  $\sage{"{0:.2f}".format(float(Gns_300[1000]))}$ & $\sage{"{0:.2f}".format(float(b_300[1000]))}$  & $\sage{"{0:.2f}".format(float(bpw_300[1000]))}$ & 0 & && \\
%\hline
%\end{tabular}}}
%\end{table}    

\end{document}
